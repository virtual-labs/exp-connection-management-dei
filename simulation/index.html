<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5G SBA Network Dashboard</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <!-- Main Container -->
    <div class="dashboard-container">

        <!-- Top Toolbar -->
        <div class="toolbar">
            <div class="toolbar-left">
                <h1>üåê Connection Management Dashboard</h1>
            </div>
            <div class="toolbar-right">
                <!-- Main action buttons -->

                <button id="btn-deploy-core" class="btn btn-secondary"
                    style="background-color: #8e44ad; color: white;">üöÄ Deploy Core</button>
                <button id="btn-add-nf" class="btn btn-primary">‚ûï Add NF</button>
                <button id="btn-pdu-session" class="btn btn-pdu">üì° Connection Management</button>
                <button id="btn-terminal" class="btn btn-terminal">üê≥ Terminal</button>
                <button id="btn-clear" class="btn btn-danger">üóëÔ∏è Clears</button>
                <button id="btn-validate" class="btn btn-info">‚úì Validate</button>
            </div>
        </div>


        <!-- Main Content Area -->
        <div class="main-content">

            <!-- Left Sidebar - NF Palette (hidden when PDU mode) -->
            <div id="nf-sidebar" class="sidebar-left">
                <div class="nf-panel-header">
                    <h3>Network Functions</h3>
                    <button id="btn-toggle-nf" class="btn-toggle-nf" title="Hide/Show Network Functions">
                        <span id="nf-toggle-icon">‚óÄ</span>
                    </button>
                </div>
                <div class="nf-palette">
                    <!-- NF types will be dynamically added here -->
                </div>


                <div class="connection-controls">
                    <h3>Create Connection</h3>
                    <button id="btn-select-source" class="btn btn-block">Select Source</button>
                    <button id="btn-select-destination" class="btn btn-block" disabled>Select Destination</button>
                    <button id="btn-cancel-connection" class="btn btn-block btn-cancel"
                        style="display:none;">Cancel</button>
                </div>
            </div>

            <!-- Connection Management Mode: Left Messages Panel (hidden by default, appears when CM mode) -->
            <div id="pdu-messages-panel" class="sidebar-left pdu-sidebar hidden">
                <div class="pdu-panel-header">
                    <h3>üì® Connection Management Messages</h3>
                    <button id="btn-close-pdu-messages" class="btn-close-pdu" title="Close CM Mode">√ó</button>
                </div>
                <div id="pdu-messages-content" class="pdu-messages-content">
                    <!-- Messages will be dynamically added here -->
                    <p class="pdu-hint">Click step buttons on the right to see message flows</p>
                </div>
            </div>

            <!-- Center Canvas Area -->
            <div class="canvas-container">
                <canvas id="main-canvas"></canvas>

                <!-- Canvas overlay messages -->
                <div id="canvas-message" class="canvas-message"></div>
            </div>

            <!-- Right Sidebar - Configuration Panel (hidden when PDU mode) -->
            <div id="config-sidebar" class="sidebar-right">
                <div id="config-panel" class="config-panel">
                    <div class="config-panel-header">
                        <h3>‚öôÔ∏è Configuration</h3>
                        <button id="btn-toggle-config" class="btn-toggle-config"
                            title="Hide/Show Configuration Panel (Ctrl+K)">
                            <span id="config-toggle-icon">‚óÄ</span>
                        </button>
                    </div>
                    <!-- Configuration form will be dynamically inserted here -->
                    <div id="config-form">
                        <p class="hint">Select a Network Function type to configure and start it</p>
                    </div>
                </div>
            </div>

            <!-- Connection Management Mode: Right Process Panel (hidden by default, appears when CM mode) -->
            <div id="pdu-process-panel" class="sidebar-right pdu-sidebar hidden">
                <div class="pdu-panel-header">
                    <h3>üì° Connection Management Process</h3>
                    <button id="btn-close-pdu-process" class="btn-close-pdu" title="Close CM Mode">√ó</button>
                </div>
                <div id="pdu-steps-container" class="pdu-steps-container">
                    <div class="pdu-step" data-step="1">
                        <button class="btn-pdu-step" id="btn-step-1">
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 1:</span>
                            <span class="step-flow">UE ‚Üí gNB</span>
                        </button>
                        <p class="step-desc">RRC Connection Request</p>
                    </div>
                    <div class="pdu-step" data-step="2">
                        <button class="btn-pdu-step" id="btn-step-2" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 2:</span>
                            <span class="step-flow">gNB ‚Üí UE</span>
                        </button>
                        <p class="step-desc">RRC Connection Setup</p>
                    </div>
                    <div class="pdu-step" data-step="3">
                        <button class="btn-pdu-step" id="btn-step-3" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 3:</span>
                            <span class="step-flow">UE ‚Üí gNB</span>
                        </button>
                        <p class="step-desc">RRC Connection Setup Complete</p>
                    </div>
                    <div class="pdu-step" data-step="4">
                        <button class="btn-pdu-step" id="btn-step-4" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 4:</span>
                            <span class="step-flow">UE ‚Üí AMF</span>
                        </button>
                        <p class="step-desc">NAS Service Request</p>
                    </div>
                    <div class="pdu-step" data-step="5">
                        <button class="btn-pdu-step" id="btn-step-5" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 5:</span>
                            <span class="step-flow">AMF Internal</span>
                        </button>
                        <p class="step-desc">Validates UE Context</p>
                    </div>
                    <div class="pdu-step" data-step="6">
                        <button class="btn-pdu-step" id="btn-step-6" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 6:</span>
                            <span class="step-flow">AMF ‚Üí SMF</span>
                        </button>
                        <p class="step-desc">Update SM Context Request</p>
                    </div>
                    <div class="pdu-step" data-step="7">
                        <button class="btn-pdu-step" id="btn-step-7" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 7:</span>
                            <span class="step-flow">SMF Internal</span>
                        </button>
                        <p class="step-desc">Internal Processing</p>
                    </div>
                    <div class="pdu-step" data-step="8">
                        <button class="btn-pdu-step" id="btn-step-8" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 8:</span>
                            <span class="step-flow">SMF ‚Üí UPF</span>
                        </button>
                        <p class="step-desc">PFCP Session Establishment</p>
                    </div>
                    <div class="pdu-step" data-step="9">
                        <button class="btn-pdu-step" id="btn-step-9" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 9:</span>
                            <span class="step-flow">UPF ‚Üí SMF</span>
                        </button>
                        <p class="step-desc">PFCP Response</p>
                    </div>
                    <div class="pdu-step" data-step="10">
                        <button class="btn-pdu-step" id="btn-step-10" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 10:</span>
                            <span class="step-flow">SMF ‚Üí AMF</span>
                        </button>
                        <p class="step-desc">Update SM Context Response</p>
                    </div>
                    <div class="pdu-step" data-step="11">
                        <button class="btn-pdu-step" id="btn-step-11" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 11:</span>
                            <span class="step-flow">AMF ‚Üí gNB</span>
                        </button>
                        <p class="step-desc">PDU Session Resource Setup Request</p>
                    </div>
                    <div class="pdu-step" data-step="12">
                        <button class="btn-pdu-step" id="btn-step-12" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 12:</span>
                            <span class="step-flow">gNB ‚Üí AMF</span>
                        </button>
                        <p class="step-desc">PDU Session Resource Setup Response</p>
                    </div>
                    <div class="pdu-step" data-step="13">
                        <button class="btn-pdu-step" id="btn-step-13" disabled>
                            <span class="step-check">‚óã</span>
                            <span class="step-label">Step 13:</span>
                            <span class="step-flow">AMF ‚Üí UE</span>
                        </button>
                        <p class="step-desc">NAS Service Accept</p>
                    </div>

                    <div class="pdu-actions">
                        <button id="btn-reset-pdu-steps" class="btn btn-secondary btn-block">üîÑ Reset Steps</button>
                    </div>
                </div>
            </div>

        </div>

        <!-- Bottom Log Panel -->
        <div class="log-panel" id="log-panel">
            <div class="log-panel-header">
                <div class="log-header-left">
                    <h3>üìã Network Function Logs</h3>
                    <button id="btn-toggle-logs" class="btn-toggle-logs" title="Hide/Show Logs (Ctrl+L)">
                        <span id="toggle-icon">‚ñº</span>
                    </button>
                </div>
                <div class="log-controls">
                    <select id="log-filter-nf">
                        <option value="all">All NFs</option>
                    </select>
                    <select id="log-filter-level">
                        <option value="all">All Levels</option>
                        <option value="ERROR">Errors</option>
                        <option value="WARNING">Warnings</option>
                        <option value="INFO">Info</option>
                        <option value="SUCCESS">Success</option>
                    </select>
                    <button id="btn-clear-logs" class="btn-small">Clear</button>
                    <button id="btn-export-logs" class="btn-small">Export</button>
                </div>
            </div>
            <div id="log-content" class="log-content">
                <!-- Logs will be dynamically added here -->
            </div>
        </div>

    </div>

    <!-- Modal for Adding NF -->
    <div id="add-nf-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2>Select Network Function Type</h2>
            <div id="nf-grid" class="nf-grid">
                <!-- NF selection buttons will be added here -->
            </div>
            <button id="modal-cancel" class="btn btn-secondary">Cancel</button>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal" style="display:none;">
        <div class="modal-content help-modal-content">
            <h2>üìö 5G Service-Based Architecture Guide</h2>
            <div class="help-content">
                <div class="help-section">
                    <h3>üèóÔ∏è Reference Architecture</h3>
                    <div class="architecture-diagram">
                        <img id="sba-diagram" src="images/sba/sba.jpg" alt="5G Service-Based Architecture"
                            style="width: 100%; max-width: 800px; height: auto; background: #1a252f; border-radius: 8px;">
                    </div>
                </div>

                <div class="help-section">
                    <h3>üöÄ Quick Start Guide</h3>
                    <ol class="help-steps">
                        <li><strong>Create Service Buses:</strong> Click "üìä Add Bus Line" to create Control Plane and
                            User Plane buses</li>
                        <li><strong>Add Network Functions:</strong> Click "‚ûï Add NF" to add AMF, SMF, UPF, etc.</li>
                        <li><strong>Connect Components:</strong> Use "Select Source" ‚Üí "Select Destination" to connect
                            NFs to buses</li>
                        <li><strong>Validate Topology:</strong> Click "‚úì Validate" to check your 5G network design</li>
                    </ol>
                </div>

                <div class="help-section">
                    <h3>üîó Connection Types</h3>
                    <ul class="help-list">
                        <li><span class="connection-type nf-bus">NF ‚Üí Bus:</span> Connect Network Functions to Service
                            Buses</li>
                        <li><span class="connection-type bus-nf">Bus ‚Üí NF:</span> Connect Service Buses to Network
                            Functions</li>
                        <li><span class="connection-type bus-bus">Bus ‚Üí Bus:</span> Create bridges between different
                            service buses</li>
                        <li><span class="connection-type nf-nf">NF ‚Üí NF:</span> Direct point-to-point connections</li>
                    </ul>
                </div>
            </div>
            <button id="help-close" class="btn btn-primary btn-block">Close</button>
        </div>
    </div>

    <!-- Load all JavaScript files in correct order -->
    <script src="js/data-store.js"></script>
    <script src="js/nf-manager.js"></script>
    <script src="js/connection-manager.js"></script>
    <script src="js/bus-manager.js"></script>
    <script src="js/ping-manager.js"></script>
    <script src="js/log-engine.js"></script>
    <script src="js/canvas-renderer.js"></script>
    <script src="js/session-manager.js"></script>
    <script src="js/packet-animator.js"></script>
    <script src="js/message-inspector.js"></script>
    <script src="js/docker.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="js/app.js"></script>
<script src="../assets/js/iframeResize.js"></script>
        
        </body>

</html>